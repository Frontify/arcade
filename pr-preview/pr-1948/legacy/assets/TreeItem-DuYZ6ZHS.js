import{j as c}from"./jsx-runtime-Nms4Y4qS.js";import{r as i}from"./index-BwDkhjyp.js";import{a as lt,u as it,b as ot,r as dt,c as ut,d as pt,I as qe,C as mt,E as ct}from"./Tree-Dv_gcqu8.js";import{e as xe,T as ft,b as V,c as Te,d as gt,a as bt,E as yt}from"./ExpandButton-DbY3d-Fg.js";import{u as Ne}from"./useDebounce-CC5nrT7M.js";import{a as De}from"./focusStyle-CBFElZiz.js";import{m as v}from"./merge-DI-veSMP.js";import{I as wt}from"./IconGrabHandle12-EPEmE8ra.js";import{n as ht}from"./noop-DX6rZLP_.js";const z=i.forwardRef(({active:a,showDragHandlerOnHoverOnly:o,activeColorStyle:d,...m},x)=>{const{selectedDragHanlderTextColor:S,dragHanlderTextColor:f}=xe[d??"neutral"];return c.jsx("button",{"aria-label":"Draggable item",...m,ref:x,className:v([De,"tw-p-1 first:tw-ml-2 tw-rounded-sm hover:tw-cursor-grab group-hover:tw-opacity-100 group-focus-within:tw-opacity-100",m.disabled?"tw-invisible tw-pointer-events-none":"tw-visible",o?!a&&"tw-opacity-0":"tw-opacity-100",a?S:f]),"data-test-id":"fondue-tree-item-drag-handle",children:c.jsx(wt,{})})});z.displayName="FondueDragHandle";z.__docgenInfo={description:"",methods:[],displayName:"FondueDragHandle",props:{active:{required:!1,tsType:{name:"boolean"},description:""},showDragHandlerOnHoverOnly:{required:!1,tsType:{name:"boolean"},description:""},activeColorStyle:{required:!1,tsType:{name:"union",raw:"'neutral' | 'soft' | 'none'",elements:[{name:"literal",value:"'neutral'"},{name:"literal",value:"'soft'"},{name:"literal",value:"'none'"}]},description:""}}};const vt=a=>{const{treeState:o}=i.useContext(lt),d=o.selectedIds.has(a),m=o.expandedIds.has(a),x=o.projection;return{isSelected:d,isExpanded:m,projection:x}},qt=({isSorting:a,wasDragging:o})=>!(a||o),Ie=i.memo(i.forwardRef(({id:a,type:o,label:d,onDrop:m,accepts:x,showCaret:S,children:f,parentId:_,level:g=0,contentComponent:D,onClick:B,onSelect:L,onExpand:b,onShrink:H,registerOverlay:E,registerNodeChildren:O,unregisterNodeChildren:u,draggable:G=!0,expandable:K=!0,showDragHandlerOnHoverOnly:Ce=!0,dragHandlerPosition:y="left",showContentWhileDragging:R=!0,itemStyle:U,ignoreItemDoubleClick:X=!1,expandOnSelect:ke=!1,"data-test-id":Se="fondue-tree-item"},q)=>{var se,le,ie,oe,de,ue,pe,me,ce,fe,ge,be,ye,we,he;const{active:s,over:W}=it(),{isSelected:w,isExpanded:h,projection:t}=vt(a),J=i.useRef(),n=(s==null?void 0:s.id)===a,e=n&&t!==null&&t!==void 0?t:null,He=typeof((le=(se=W==null?void 0:W.data)==null?void 0:se.current)==null?void 0:le.accepts)=="string"?(ie=W.data.current.accepts)==null?void 0:ie.split(", "):[],Ee=typeof(e==null?void 0:e.accepts)=="string"?(oe=e.accepts)==null?void 0:oe.split(", "):[],I=((de=s==null?void 0:s.data.current)==null?void 0:de.type)||"",C=((ue=t==null?void 0:t.previousNode)==null?void 0:ue.depth)!==void 0&&(t==null?void 0:t.depth)>((pe=t==null?void 0:t.previousNode)==null?void 0:pe.depth),Re=C&&t.depth-1===((me=t==null?void 0:t.previousNode)==null?void 0:me.depth),F=C&&((ce=t==null?void 0:t.previousNode)==null?void 0:ce.accepts)!==void 0&&(((fe=t==null?void 0:t.previousNode)==null?void 0:fe.accepts.includes(`${I}-deeper`))||((ge=t==null?void 0:t.previousNode)==null?void 0:ge.accepts.includes(`${I}-within`))),We=n&&Re&&((be=e==null?void 0:e.previousNode)==null?void 0:be.accepts)!==void 0&&((ye=e==null?void 0:e.previousNode)==null?void 0:ye.accepts.includes(`${I}-within`))||(e==null?void 0:e.isWithinParent)&&Ee.includes(`${I}-within`),k=n&&(s==null?void 0:s.data.current)&&(He.includes(I)&&!C||We),Q=Ne(r=>{J.current===r&&(b==null||b(r))},ct);i.useEffect(()=>{var r,p,N;n&&(J.current=C?(r=e==null?void 0:e.previousNode)==null?void 0:r.id:null),n&&F&&(e!=null&&e.parentId)&&e.previousNode&&e.parentId===e.previousNode.id&&e.parentId!==((N=(p=s==null?void 0:s.data)==null?void 0:p.current)==null?void 0:N.parentId)&&Q(e==null?void 0:e.parentId)},[s==null?void 0:s.data,e==null?void 0:e.parentId,e==null?void 0:e.previousNode,Q,n,F,C]);const Ae=i.useCallback(r=>{var ve;const{over:p,active:N}=r;!n||!e||N.id===(p==null?void 0:p.id)&&(e==null?void 0:e.depth)===((ve=N.data.current)==null?void 0:ve.level)||n&&p&&k&&m&&m({id:N.id,parentId:e.parentId,sort:e.position,contentComponent:D,parentType:e.type})},[n,e,k,m,D]),Me=i.useCallback(r=>{r.active.id===a&&(E==null||E({contentComponent:D,children:f,id:a,label:d,level:g,dragHandlerPosition:y,showContentWhileDragging:R}))},[f,D,y,a,d,g,E,R]),Ve=i.useCallback(r=>{r.active.id===a&&document.body.style.setProperty("cursor",k?"grabbing":"no-drop")},[k,a]);ot({onDragEnd:Ae,onDragStart:Me,onDragMove:Ve});const Z=i.useCallback(r=>{r==null||r.stopPropagation(),h?H==null||H(a):b==null||b(a)},[a,h,b,H]),_e=Ne(r=>{r.stopPropagation(),!(X&&r.detail>=2)&&(ke&&Z(),L==null||L(a),B==null||B(a))},X?300:0),P=_&&(s==null?void 0:s.id)===_,j=i.Children.count(f)>0,{enrichedChildren:Y,childrenIds:Be}=i.useMemo(()=>{const r=dt(f,{parentId:a,level:g+1});return{enrichedChildren:r,childrenIds:r.map(p=>p.props.id)}},[f,a,g]),{attributes:Le,listeners:Oe,transform:A,transition:Fe,setDraggableNodeRef:Ye,setDroppableNodeRef:$e,setActivatorNodeRef:ze}=ut({id:a,disabled:!G,data:{type:o,accepts:x,parentId:_,level:g},animateLayoutChanges:qt,transition:null});pt(()=>{if(i.Children.count(Y)===0){u==null||u(a);return}if(n||P){u==null||u(a);return}h?O==null||O({id:a,children:Y}):u==null||u(a)},[n,h,P,Y,a]);const l=i.useMemo(()=>({spacingY:"none",contentHight:"single-line",shadow:"none",borderRadius:"small",borderWidth:"none",borderStyle:"none",activeColorStyle:"neutral",...U}),[U]),T=xe[l.activeColorStyle??"neutral"],{liClassName:Ge,backgroundClassName:Ke}=i.useMemo(()=>({liClassName:v([De,"tw-box-content tw-relative tw-cursor-default tw-transition-colors tw-outline-none tw-ring-inset tw-group tw-no-underline tw-leading-5",!n&&w?T.selectedTextColor:T.textColor,ft[l.spacingY??"none"]]),backgroundClassName:v(["tw-block tw-absolute tw-inset-0 tw-transition-colors -tw-z-10",l.borderWidth!=="none"?V[l.borderRadius??"small"]:"",!n&&(!w||l.activeColorStyle!=="neutral")&&T.pressedBackgroundColor,!n&&w?T.selectedBackgroundColor:T.backgroundColor])}),[n,w,l,T]),Ue=R?!0:!n,Xe=v(["tw-max-w-full tw-grow tw-overflow-hidden",n&&R?"tw-opacity-75 tw-blur-sm tw-grayscale":""]),Je=h&&!n,ee=G&&!n,Qe=d!==void 0&&!n,M=!n&&K&&(S===void 0?j:S);let $="";!n&&!h&&M&&F&&((we=t==null?void 0:t.previousNode)==null?void 0:we.id)===a&&(t==null?void 0:t.depth)>((he=t==null?void 0:t.previousNode)==null?void 0:he.depth)&&($=v(["tw-border-solid tw-border-box-selected-strong",V[l.borderRadius??"small"],Te.small]));const Ze=l.borderWidth!=="none"&&$===""?v([Te[l.borderWidth??"none"],V[l.borderRadius??"small"],gt[l.borderStyle??"none"]]):"",Pe=l.contentHight==="single-line"?"tw-h-10":"tw-h-fit",je=l.contentHight==="single-line"?"tw-h-12":"tw-h-fit",et=v(["tw-relative tw-z-0 tw-transition-colors tw-flex tw-items-center tw-leading-5 tw-width-fit tw-justify-between",bt[l.shadow??"none"],n?"tw-border-dashed tw-border-2 tw-pr-0":Ze,n&&V[l.borderRadius??"small"],n?je:Pe,n&&(k?"tw-border-box-selected-strong tw-bg-box-selected-hover":"tw-bg-box-negative-hover tw-border-box-negative-strong-hover"),$]),te=e!=null&&e.depth?e.depth*qe:void 0,ae=n?0:g*qe,tt={paddingLeft:te??ae},at=l.borderWidth!=="none"?{}:{marginLeft:-1*(te??ae)},nt={transform:mt.Transform.toString(A),transition:Fe},ne={...Oe,...Le},rt=y!=="none"?ne:{},re=y!=="none"?c.jsx(z,{...rt,active:w,ref:ze,disabled:!ee,"aria-hidden":!ee,showDragHandlerOnHoverOnly:Ce,activeColorStyle:l.activeColorStyle??"neutral"}):null,st=y==="none"?{...ne}:{};return i.createElement("li",{...st,id:a,key:a,tabIndex:0,role:"treeitem",style:tt,onKeyDown:ht,"aria-label":d,"aria-level":g+1,onClick:_e,className:Ge,ref:r=>{$e(r),typeof q=="function"?q(r):q!=null&&q.current&&(q.current=r)},"data-test-id":Se,"aria-selected":w,"aria-expanded":h,"data-has-children":j,"aria-owns":Be.join(" ")},c.jsxs("div",{ref:Ye,className:et,style:nt,children:[c.jsx("span",{className:Ke,style:at,"aria-hidden":!0}),y==="left"&&re,K&&c.jsx(yt,{active:A!=null&&A.y?!1:w,onClick:Z,expanded:Je,disabled:!M,"aria-hidden":!M,className:M?"tw-visible":"tw-invisible tw-pointer-events-none"}),Qe&&c.jsx("span",{className:"first:tw-ml-3.5 tw-w-full tw-h-full tw-flex tw-items-center",children:d}),Ue&&c.jsx("div",{className:Xe,children:D}),y==="right"&&re]}))}));Ie.displayName="FondueTreeItem";Ie.__docgenInfo={description:"",methods:[],displayName:"FondueTreeItem",props:{level:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},levelConstraint:{required:!1,tsType:{name:"Nullable",elements:[{name:"number"}],raw:"Nullable<number>"},description:""},parentId:{required:!1,tsType:{name:"string"},description:""},isSelected:{required:!1,tsType:{name:"boolean"},description:""},isExpanded:{required:!1,tsType:{name:"boolean"},description:""},onSelect:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"onSelect is passed by the Tree component when cloning the TreeItem"},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"onClick is the user defined callback to run after the onSelect"},onExpand:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},onShrink:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},projection:{required:!1,tsType:{name:"Nullable",elements:[{name:"signature",type:"object",raw:`{
    depth: number;
    maxDepth: number;
    minDepth: number;
    position: number;
    type?: string;
    accepts?: string;
    parentId: Nullable<string>;
    isWithinParent: boolean | undefined;
    previousNode: Nullable<{ id: string; depth: number; accepts?: string }>;
}`,signature:{properties:[{key:"depth",value:{name:"number",required:!0}},{key:"maxDepth",value:{name:"number",required:!0}},{key:"minDepth",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}},{key:"type",value:{name:"string",required:!1}},{key:"accepts",value:{name:"string",required:!1}},{key:"parentId",value:{name:"Nullable",elements:[{name:"string"}],raw:"Nullable<string>",required:!0}},{key:"isWithinParent",value:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}],required:!0}},{key:"previousNode",value:{name:"Nullable",elements:[{name:"signature",type:"object",raw:"{ id: string; depth: number; accepts?: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"depth",value:{name:"number",required:!0}},{key:"accepts",value:{name:"string",required:!1}}]}}],raw:"Nullable<{ id: string; depth: number; accepts?: string }>",required:!0}}]}}],raw:"Nullable<Projection>"},description:""},registerOverlay:{required:!1,tsType:{name:"signature",type:"function",raw:"(overlay: Overlay) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    id: string;
    label?: string;
    level?: number;
    children: ReactNode;
    contentComponent?: ReactNode;
    isSelected?: boolean;
    dragHandlerPosition?: DragHandlerPosition;
    showContentWhileDragging: boolean;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!1}},{key:"level",value:{name:"number",required:!1}},{key:"children",value:{name:"ReactNode",required:!0}},{key:"contentComponent",value:{name:"ReactNode",required:!1}},{key:"isSelected",value:{name:"boolean",required:!1}},{key:"dragHandlerPosition",value:{name:"union",raw:"'left' | 'right' | 'none'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"},{name:"literal",value:"'none'"}],required:!1}},{key:"showContentWhileDragging",value:{name:"boolean",required:!0}}]}},name:"overlay"}],return:{name:"void"}}},description:""},unregisterNodeChildren:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: string) => void",signature:{arguments:[{type:{name:"string"},name:"payload"}],return:{name:"void"}}},description:""},registerNodeChildren:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: RegisterNodeChildrenPayload) => void",signature:{arguments:[{type:{name:"Extract['payload']",raw:"Extract<TreeStateAction, { type: 'REGISTER_NODE_CHILDREN' }>['payload']"},name:"payload"}],return:{name:"void"}}},description:""},draggable:{defaultValue:{value:"true",computed:!1},required:!1},expandable:{defaultValue:{value:"true",computed:!1},required:!1},showDragHandlerOnHoverOnly:{defaultValue:{value:"true",computed:!1},required:!1},dragHandlerPosition:{defaultValue:{value:"'left'",computed:!1},required:!1},showContentWhileDragging:{defaultValue:{value:"true",computed:!1},required:!1},ignoreItemDoubleClick:{defaultValue:{value:"false",computed:!1},required:!1},expandOnSelect:{defaultValue:{value:"false",computed:!1},required:!1},"data-test-id":{defaultValue:{value:"'fondue-tree-item'",computed:!1},required:!1}}};export{Ie as T,vt as u};
