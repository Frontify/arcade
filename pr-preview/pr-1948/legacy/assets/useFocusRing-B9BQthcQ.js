import{r as c}from"./index-ClcD9ViR.js";import{$ as A,a as K}from"./useEffectEvent-23OTMzEQ.js";const g=e=>{var n;return(n=e==null?void 0:e.ownerDocument)!==null&&n!==void 0?n:document},b=e=>e&&"window"in e&&e.window===e?e:g(e).defaultView||window;function m(e){var n;return typeof window>"u"||window.navigator==null?!1:((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.brands.some(t=>e.test(t.brand)))||e.test(window.navigator.userAgent)}function T(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function l(e){let n=null;return()=>(n==null&&(n=e()),n)}const x=l(function(){return T(/^Mac/i)}),V=l(function(){return T(/^iPhone/i)}),O=l(function(){return T(/^iPad/i)||x()&&navigator.maxTouchPoints>1}),_=l(function(){return V()||O()}),te=l(function(){return x()||_()}),ne=l(function(){return m(/AppleWebKit/i)&&!j()}),j=l(function(){return m(/Chrome/i)}),k=l(function(){return m(/Android/i)}),re=l(function(){return m(/Firefox/i)});function R(e){return e.mozInputSource===0&&e.isTrusted?!0:k()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function oe(e){return!k()&&e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"}class U{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(n,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=n}}function M(e){let n=c.useRef({isFocused:!1,observer:null});A(()=>{const r=n.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=K(r=>{e==null||e(r)});return c.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){n.current.isFocused=!0;let o=r.target,a=i=>{n.current.isFocused=!1,o.disabled&&t(new U("blur",i)),n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};o.addEventListener("focusout",a,{once:!0}),n.current.observer=new MutationObserver(()=>{if(n.current.isFocused&&o.disabled){var i;(i=n.current.observer)===null||i===void 0||i.disconnect();let f=o===document.activeElement?null:document.activeElement;o.dispatchEvent(new FocusEvent("blur",{relatedTarget:f})),o.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:f}))}}),n.current.observer.observe(o,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function q(e){let{isDisabled:n,onFocus:t,onBlur:r,onFocusChange:o}=e;const a=c.useCallback(u=>{if(u.target===u.currentTarget)return r&&r(u),o&&o(!1),!0},[r,o]),i=M(a),f=c.useCallback(u=>{const s=g(u.target);u.target===u.currentTarget&&s.activeElement===u.target&&(t&&t(u),o&&o(!0),i(u))},[o,t,i]);return{focusProps:{onFocus:!n&&(t||o||r)?f:void 0,onBlur:!n&&(r||o)?a:void 0}}}let v=null,F=new Set,p=new Map,$=!1,y=!1;const z={Tab:!0,Escape:!0};function E(e,n){for(let t of F)t(e,n)}function G(e){return!(e.metaKey||!x()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function w(e){$=!0,G(e)&&(v="keyboard",E("keyboard",e))}function d(e){v="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&($=!0,E("pointer",e))}function C(e){R(e)&&($=!0,v="virtual")}function W(e){e.target===window||e.target===document||(!$&&!y&&(v="virtual",E("virtual",e)),$=!1,y=!1)}function D(){$=!1,y=!0}function L(e){if(typeof window>"u"||p.get(b(e)))return;const n=b(e),t=g(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){$=!0,r.apply(this,arguments)},t.addEventListener("keydown",w,!0),t.addEventListener("keyup",w,!0),t.addEventListener("click",C,!0),n.addEventListener("focus",W,!0),n.addEventListener("blur",D,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",d,!0),t.addEventListener("pointermove",d,!0),t.addEventListener("pointerup",d,!0)):(t.addEventListener("mousedown",d,!0),t.addEventListener("mousemove",d,!0),t.addEventListener("mouseup",d,!0)),n.addEventListener("beforeunload",()=>{H(e)},{once:!0}),p.set(n,{focus:r})}const H=(e,n)=>{const t=b(e),r=g(e);n&&r.removeEventListener("DOMContentLoaded",n),p.has(t)&&(t.HTMLElement.prototype.focus=p.get(t).focus,r.removeEventListener("keydown",w,!0),r.removeEventListener("keyup",w,!0),r.removeEventListener("click",C,!0),t.removeEventListener("focus",W,!0),t.removeEventListener("blur",D,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",d,!0),r.removeEventListener("pointermove",d,!0),r.removeEventListener("pointerup",d,!0)):(r.removeEventListener("mousedown",d,!0),r.removeEventListener("mousemove",d,!0),r.removeEventListener("mouseup",d,!0)),p.delete(t))};function N(e){const n=g(e);let t;return n.readyState!=="loading"?L(e):(t=()=>{L(e)},n.addEventListener("DOMContentLoaded",t)),()=>H(e,t)}typeof document<"u"&&N();function S(){return v!=="pointer"}function ae(){return v}function ie(e){v=e,E(e,null)}const Y=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function J(e,n,t){var r;const o=typeof window<"u"?b(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?b(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,i=typeof window<"u"?b(t==null?void 0:t.target).HTMLElement:HTMLElement,f=typeof window<"u"?b(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return e=e||(t==null?void 0:t.target)instanceof o&&!Y.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof a||(t==null?void 0:t.target)instanceof i&&(t==null?void 0:t.target.isContentEditable),!(e&&n==="keyboard"&&t instanceof f&&!z[t.key])}function Q(e,n,t){L(),c.useEffect(()=>{let r=(o,a)=>{J(!!(t!=null&&t.isTextInput),o,a)&&e(S())};return F.add(r),()=>{F.delete(r)}},n)}function X(e){let{isDisabled:n,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:o}=e,a=c.useRef({isFocusWithin:!1}),i=c.useCallback(s=>{a.current.isFocusWithin&&!s.currentTarget.contains(s.relatedTarget)&&(a.current.isFocusWithin=!1,t&&t(s),o&&o(!1))},[t,o,a]),f=M(i),u=c.useCallback(s=>{!a.current.isFocusWithin&&document.activeElement===s.target&&(r&&r(s),o&&o(!0),a.current.isFocusWithin=!0,f(s))},[r,o,f]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:i}}}function ue(e={}){let{autoFocus:n=!1,isTextInput:t,within:r}=e,o=c.useRef({isFocused:!1,isFocusVisible:n||S()}),[a,i]=c.useState(!1),[f,u]=c.useState(()=>o.current.isFocused&&o.current.isFocusVisible),s=c.useCallback(()=>u(o.current.isFocused&&o.current.isFocusVisible),[]),P=c.useCallback(h=>{o.current.isFocused=h,i(h),s()},[s]);Q(h=>{o.current.isFocusVisible=h,s()},[],{isTextInput:t});let{focusProps:I}=q({isDisabled:r,onFocusChange:P}),{focusWithinProps:B}=X({isDisabled:!r,onFocusWithinChange:P});return{isFocused:a,isFocusVisible:f,focusProps:r?B:I}}export{ue as $,X as a,b,g as c,k as d,j as e,ae as f,ie as g,S as h,q as i,_ as j,ne as k,x as l,te as m,re as n,O as o,oe as p,R as q};
