import{a as V,$ as B}from"./SSRProvider-4hSGecE0.js";import{r as d}from"./index-BEEaWAwe.js";import{d as T}from"./useFocusRing-BuOUPy6p.js";function G(a,e,t){let i=d.useRef(e),o=V(()=>{t&&t(i.current)});d.useEffect(()=>{var n;let r=a==null||(n=a.current)===null||n===void 0?void 0:n.form;return r==null||r.addEventListener("reset",o),()=>{r==null||r.removeEventListener("reset",o)}},[a,o])}function H(a,e,t){let{validationBehavior:i,focus:o}=a;B(()=>{if(i==="native"&&(t!=null&&t.current)){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(l),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(j(t.current))}});let n=V(()=>{e.resetValidation()}),r=V(l=>{var s;e.displayValidation.isInvalid||e.commitValidation();let c=t==null||(s=t.current)===null||s===void 0?void 0:s.form;if(!l.defaultPrevented&&t&&c&&F(c)===t.current){var v;o?o():(v=t.current)===null||v===void 0||v.focus(),T("keyboard")}l.preventDefault()}),u=V(()=>{e.commitValidation()});d.useEffect(()=>{let l=t==null?void 0:t.current;if(!l)return;let s=l.form;return l.addEventListener("invalid",r),l.addEventListener("change",u),s==null||s.addEventListener("reset",n),()=>{l.removeEventListener("invalid",r),l.removeEventListener("change",u),s==null||s.removeEventListener("reset",n)}},[t,r,u,n,i])}function U(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function j(a){return{isInvalid:!a.validity.valid,validationDetails:U(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function F(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...M,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:M,validationErrors:[]},Q=d.createContext({}),L="__formValidationState"+Date.now();function J(a){if(a[L]){let{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:o,commitValidation:n}=a[L];return{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:o,commitValidation:n}}return _(a)}function _(a){let{isInvalid:e,validationState:t,name:i,value:o,builtinValidation:n,validate:r,validationBehavior:u="aria"}=a;t&&(e||(e=t==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,s=d.useMemo(()=>D(k(r,o)),[r,o]);n!=null&&n.validationDetails.valid&&(n=null);let c=d.useContext(Q),v=d.useMemo(()=>i?Array.isArray(i)?i.flatMap(f=>I(c[f])):I(c[i]):[],[c,i]),[w,A]=d.useState(c),[S,b]=d.useState(!1);c!==w&&(A(c),b(!1));let p=d.useMemo(()=>D(S?[]:v),[S,v]),x=d.useRef(m),[E,y]=d.useState(m),$=d.useRef(m),O=()=>{if(!R)return;g(!1);let f=s||n||x.current;h(f,$.current)||($.current=f,y(f))},[R,g]=d.useState(!1);return d.useEffect(O),{realtimeValidation:l||p||s||n||m,displayValidation:u==="native"?l||p||E:l||p||s||n||E,updateValidation(f){u==="aria"&&!h(E,f)?y(f):x.current=f},resetValidation(){let f=m;h(f,$.current)||($.current=f,y(f)),u==="native"&&g(!1),b(!0)},commitValidation(){u==="native"&&g(!0),b(!0)}}}function I(a){return a?Array.isArray(a)?a:[a]:[]}function k(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return I(t)}return[]}function D(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:C}:null}function h(a,e){return a===e?!0:a&&e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,i)=>t===e.validationErrors[i])&&Object.entries(a.validationDetails).every(([t,i])=>e.validationDetails[t]===i)}function K(...a){let e=new Set,t=!1,i={...M};for(let r of a){var o,n;for(let u of r.validationErrors)e.add(u);t||(t=r.isInvalid);for(let u in i)(o=i)[n=u]||(o[n]=r.validationDetails[u])}return i.valid=!t,{isInvalid:t,validationErrors:[...e],validationDetails:i}}export{G as $,J as a,H as b,m as c,L as d,K as e};
