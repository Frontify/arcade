import{a as V,$ as B}from"./SSRProvider-CYXx33DY.js";import{r as o}from"./index-BwDkhjyp.js";import{d as T}from"./useFocusRing-Vzyl7-Lk.js";function G(a,e,t){let i=o.useRef(e),d=V(()=>{t&&t(i.current)});o.useEffect(()=>{var r;let l=a==null||(r=a.current)===null||r===void 0?void 0:r.form;return l==null||l.addEventListener("reset",d),()=>{l==null||l.removeEventListener("reset",d)}},[a,d])}function H(a,e,t){let{validationBehavior:i,focus:d}=a;B(()=>{if(i==="native"&&(t!=null&&t.current)){let n=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(n),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(j(t.current))}});let r=V(()=>{e.resetValidation()}),l=V(n=>{var s;e.displayValidation.isInvalid||e.commitValidation();let c=t==null||(s=t.current)===null||s===void 0?void 0:s.form;if(!n.defaultPrevented&&t&&c&&F(c)===t.current){var f;d?d():(f=t.current)===null||f===void 0||f.focus(),T("keyboard")}n.preventDefault()}),v=V(()=>{e.commitValidation()});o.useEffect(()=>{let n=t==null?void 0:t.current;if(!n)return;let s=n.form;return n.addEventListener("invalid",l),n.addEventListener("change",v),s==null||s.addEventListener("reset",r),()=>{n.removeEventListener("invalid",l),n.removeEventListener("change",v),s==null||s.removeEventListener("reset",r)}},[t,l,v,r,i])}function U(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function j(a){return{isInvalid:!a.validity.valid,validationDetails:U(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function F(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...M,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:M,validationErrors:[]},Q=o.createContext({}),L="__formValidationState"+Date.now();function J(a){if(a[L]){let{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:d,commitValidation:r}=a[L];return{realtimeValidation:e,displayValidation:t,updateValidation:i,resetValidation:d,commitValidation:r}}return _(a)}function _(a){let{isInvalid:e,validationState:t,name:i,value:d,builtinValidation:r,validate:l,validationBehavior:v="aria"}=a;t&&(e||(e=t==="invalid"));let n=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,s=o.useMemo(()=>D(k(l,d)),[l,d]);r!=null&&r.validationDetails.valid&&(r=null);let c=o.useContext(Q),f=o.useMemo(()=>i?Array.isArray(i)?i.flatMap(u=>I(c[u])):I(c[i]):[],[c,i]),[w,A]=o.useState(c),[S,b]=o.useState(!1);c!==w&&(A(c),b(!1));let p=o.useMemo(()=>D(S?[]:f),[S,f]),x=o.useRef(m),[E,y]=o.useState(m),$=o.useRef(m),O=()=>{if(!R)return;g(!1);let u=s||r||x.current;h(u,$.current)||($.current=u,y(u))},[R,g]=o.useState(!1);return o.useEffect(O),{realtimeValidation:n||p||s||r||m,displayValidation:v==="native"?n||p||E:n||p||s||r||E,updateValidation(u){v==="aria"&&!h(E,u)?y(u):x.current=u},resetValidation(){let u=m;h(u,$.current)||($.current=u,y(u)),v==="native"&&g(!1),b(!0)},commitValidation(){v==="native"&&g(!0),b(!0)}}}function I(a){return a?Array.isArray(a)?a:[a]:[]}function k(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return I(t)}return[]}function D(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:C}:null}function h(a,e){return a===e?!0:a&&e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,i)=>t===e.validationErrors[i])&&Object.entries(a.validationDetails).every(([t,i])=>e.validationDetails[t]===i)}function K(...a){let e=new Set,t=!1,i={...M};for(let l of a){var d,r;for(let v of l.validationErrors)e.add(v);t||(t=l.isInvalid);for(let v in i)(d=i)[r=v]||(d[r]=l.validationDetails[v])}return i.valid=!t,{isInvalid:t,validationErrors:[...e],validationDetails:i}}export{G as $,J as a,H as b,m as c,L as d,K as e};
