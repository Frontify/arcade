import{j as c}from"./jsx-runtime-Nms4Y4qS.js";import{r as d}from"./index-BwDkhjyp.js";import{a as st,u as lt,b as dt,r as it,c as ot,d as ut,I as ve,C as pt,E as mt}from"./Tree-CVMTatqj.js";import{e as qe,T as ct,b as M,c as Ie,d as ft,a as gt,E as bt}from"./ExpandButton-DbY3d-Fg.js";import{u as Ne}from"./useDebounce-CC5nrT7M.js";import{a as Te}from"./focusStyle-CBFElZiz.js";import{m as v}from"./merge-DI-veSMP.js";import{I as wt}from"./IconGrabHandle12-IS3l0vsO.js";import{n as yt}from"./noop-DX6rZLP_.js";const $=d.forwardRef(({active:a,showDragHandlerOnHoverOnly:i,activeColorStyle:o,...m},q)=>{const{selectedDragHanlderTextColor:k,dragHanlderTextColor:f}=qe[o??"neutral"];return c.jsx("button",{"aria-label":"Draggable item",...m,ref:q,className:v([Te,"tw-p-1 first:tw-ml-2 tw-rounded-sm hover:tw-cursor-grab group-hover:tw-opacity-100 group-focus-within:tw-opacity-100",m.disabled?"tw-invisible tw-pointer-events-none":"tw-visible",i?!a&&"tw-opacity-0":"tw-opacity-100",a?k:f]),"data-test-id":"fondue-tree-item-drag-handle",children:c.jsx(wt,{})})});$.displayName="FondueDragHandle";$.__docgenInfo={description:"",methods:[],displayName:"FondueDragHandle"};const ht=a=>{const{treeState:i}=d.useContext(st),o=i.selectedIds.has(a),m=i.expandedIds.has(a),q=i.projection;return{isSelected:o,isExpanded:m,projection:q}},vt=({isSorting:a,wasDragging:i})=>!(a||i),xe=d.memo(({id:a,type:i,label:o,onDrop:m,accepts:q,showCaret:k,children:f,parentId:V,level:g=0,contentComponent:T,onClick:_,onSelect:B,onExpand:b,onShrink:S,registerOverlay:R,registerNodeChildren:L,unregisterNodeChildren:u,draggable:z=!0,expandable:G=!0,showDragHandlerOnHoverOnly:De=!0,dragHandlerPosition:w="left",showContentWhileDragging:E=!0,itemStyle:K,ignoreItemDoubleClick:U=!1,expandOnSelect:Ce=!1,"data-test-id":ke="fondue-tree-item"})=>{var ne,se,le,de,ie,oe,ue,pe,me,ce,fe,ge,be,we,ye;const{active:s,over:H}=lt(),{isSelected:y,isExpanded:h,projection:t}=ht(a),X=d.useRef(),r=(s==null?void 0:s.id)===a,e=r&&t!==null&&t!==void 0?t:null,Se=typeof((se=(ne=H==null?void 0:H.data)==null?void 0:ne.current)==null?void 0:se.accepts)=="string"?(le=H.data.current.accepts)==null?void 0:le.split(", "):[],Re=typeof(e==null?void 0:e.accepts)=="string"?(de=e.accepts)==null?void 0:de.split(", "):[],x=((ie=s==null?void 0:s.data.current)==null?void 0:ie.type)||"",D=((oe=t==null?void 0:t.previousNode)==null?void 0:oe.depth)!==void 0&&(t==null?void 0:t.depth)>((ue=t==null?void 0:t.previousNode)==null?void 0:ue.depth),Ee=D&&t.depth-1===((pe=t==null?void 0:t.previousNode)==null?void 0:pe.depth),F=D&&((me=t==null?void 0:t.previousNode)==null?void 0:me.accepts)!==void 0&&(((ce=t==null?void 0:t.previousNode)==null?void 0:ce.accepts.includes(`${x}-deeper`))||((fe=t==null?void 0:t.previousNode)==null?void 0:fe.accepts.includes(`${x}-within`))),He=r&&Ee&&((ge=e==null?void 0:e.previousNode)==null?void 0:ge.accepts)!==void 0&&((be=e==null?void 0:e.previousNode)==null?void 0:be.accepts.includes(`${x}-within`))||(e==null?void 0:e.isWithinParent)&&Re.includes(`${x}-within`),C=r&&(s==null?void 0:s.data.current)&&(Se.includes(x)&&!D||He),J=Ne(n=>{X.current===n&&(b==null||b(n))},mt);d.useEffect(()=>{var n,p,N;r&&(X.current=D?(n=e==null?void 0:e.previousNode)==null?void 0:n.id:null),r&&F&&(e!=null&&e.parentId)&&e.previousNode&&e.parentId===e.previousNode.id&&e.parentId!==((N=(p=s==null?void 0:s.data)==null?void 0:p.current)==null?void 0:N.parentId)&&J(e==null?void 0:e.parentId)},[s==null?void 0:s.data,e==null?void 0:e.parentId,e==null?void 0:e.previousNode,J,r,F,D]);const We=d.useCallback(n=>{var he;const{over:p,active:N}=n;!r||!e||N.id===(p==null?void 0:p.id)&&(e==null?void 0:e.depth)===((he=N.data.current)==null?void 0:he.level)||r&&p&&C&&m&&m({id:N.id,parentId:e.parentId,sort:e.position,contentComponent:T,parentType:e.type})},[r,e,C,m,T]),Ae=d.useCallback(n=>{n.active.id===a&&(R==null||R({contentComponent:T,children:f,id:a,label:o,level:g,dragHandlerPosition:w,showContentWhileDragging:E}))},[f,T,w,a,o,g,R,E]),Me=d.useCallback(n=>{n.active.id===a&&document.body.style.setProperty("cursor",C?"grabbing":"no-drop")},[C,a]);dt({onDragEnd:We,onDragStart:Ae,onDragMove:Me});const Q=d.useCallback(n=>{n==null||n.stopPropagation(),h?S==null||S(a):b==null||b(a)},[a,h,b,S]),Ve=Ne(n=>{n.stopPropagation(),!(U&&n.detail>=2)&&(Ce&&Q(),B==null||B(a),_==null||_(a))},U?300:0),Z=V&&(s==null?void 0:s.id)===V,P=d.Children.count(f)>0,{enrichedChildren:O,childrenIds:_e}=d.useMemo(()=>{const n=it(f,{parentId:a,level:g+1});return{enrichedChildren:n,childrenIds:n.map(p=>p.props.id)}},[f,a,g]),{attributes:Be,listeners:Le,transform:W,transition:Fe,setDraggableNodeRef:Oe,setDroppableNodeRef:Ye,setActivatorNodeRef:$e}=ot({id:a,disabled:!z,data:{type:i,accepts:q,parentId:V,level:g},animateLayoutChanges:vt,transition:null});ut(()=>{if(d.Children.count(O)===0){u==null||u(a);return}if(r||Z){u==null||u(a);return}h?L==null||L({id:a,children:O}):u==null||u(a)},[r,h,Z,O,a]);const l=d.useMemo(()=>({spacingY:"none",contentHight:"single-line",shadow:"none",borderRadius:"small",borderWidth:"none",borderStyle:"none",activeColorStyle:"neutral",...K}),[K]),I=qe[l.activeColorStyle??"neutral"],{liClassName:ze,backgroundClassName:Ge}=d.useMemo(()=>({liClassName:v([Te,"tw-box-content tw-relative tw-cursor-default tw-transition-colors tw-outline-none tw-ring-inset tw-group tw-no-underline tw-leading-5",!r&&y?I.selectedTextColor:I.textColor,ct[l.spacingY??"none"]]),backgroundClassName:v(["tw-block tw-absolute tw-inset-0 tw-transition-colors -tw-z-10",l.borderWidth!=="none"?M[l.borderRadius??"small"]:"",!r&&(!y||l.activeColorStyle!=="neutral")&&I.pressedBackgroundColor,!r&&y?I.selectedBackgroundColor:I.backgroundColor])}),[r,y,l,I]),Ke=E?!0:!r,Ue=v(["tw-max-w-full tw-grow tw-overflow-hidden",r&&E?"tw-opacity-75 tw-blur-sm tw-grayscale":""]),Xe=h&&!r,j=z&&!r,Je=o!==void 0&&!r,A=!r&&G&&(k===void 0?P:k);let Y="";!r&&!h&&A&&F&&((we=t==null?void 0:t.previousNode)==null?void 0:we.id)===a&&(t==null?void 0:t.depth)>((ye=t==null?void 0:t.previousNode)==null?void 0:ye.depth)&&(Y=v(["tw-border-solid tw-border-box-selected-strong",M[l.borderRadius??"small"],Ie.small]));const Qe=l.borderWidth!=="none"&&Y===""?v([Ie[l.borderWidth??"none"],M[l.borderRadius??"small"],ft[l.borderStyle??"none"]]):"",Ze=l.contentHight==="single-line"?"tw-h-10":"tw-h-fit",Pe=l.contentHight==="single-line"?"tw-h-12":"tw-h-fit",je=v(["tw-relative tw-z-0 tw-transition-colors tw-flex tw-items-center tw-leading-5 tw-width-fit tw-justify-between",gt[l.shadow??"none"],r?"tw-border-dashed tw-border-2 tw-pr-0":Qe,r&&M[l.borderRadius??"small"],r?Pe:Ze,r&&(C?"tw-border-box-selected-strong tw-bg-box-selected-hover":"tw-bg-box-negative-hover tw-border-box-negative-strong-hover"),Y]),ee=e!=null&&e.depth?e.depth*ve:void 0,te=r?0:g*ve,et={paddingLeft:ee??te},tt=l.borderWidth!=="none"?{}:{marginLeft:-1*(ee??te)},at={transform:pt.Transform.toString(W),transition:Fe},ae={...Le,...Be},rt=w!=="none"?ae:{},re=w!=="none"?c.jsx($,{...rt,active:y,ref:$e,disabled:!j,"aria-hidden":!j,showDragHandlerOnHoverOnly:De,activeColorStyle:l.activeColorStyle??"neutral"}):null,nt=w==="none"?{...ae}:{};return d.createElement("li",{...nt,id:a,key:a,tabIndex:0,role:"treeitem",style:et,onKeyDown:yt,"aria-label":o,"aria-level":g+1,onClick:Ve,className:ze,ref:Ye,"data-test-id":ke,"aria-selected":y,"aria-expanded":h,"data-has-children":P,"aria-owns":_e.join(" ")},c.jsxs("div",{ref:Oe,className:je,style:at,children:[c.jsx("span",{className:Ge,style:tt,"aria-hidden":!0}),w==="left"&&re,G&&c.jsx(bt,{active:W!=null&&W.y?!1:y,onClick:Q,expanded:Xe,disabled:!A,"aria-hidden":!A,className:A?"tw-visible":"tw-invisible tw-pointer-events-none"}),Je&&c.jsx("span",{className:"first:tw-ml-3.5 tw-w-full tw-h-full tw-flex tw-items-center",children:o}),Ke&&c.jsx("div",{className:Ue,children:T}),w==="right"&&re]}))});xe.displayName="FondueTreeItem";xe.__docgenInfo={description:"",methods:[],displayName:"FondueTreeItem",props:{level:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},levelConstraint:{required:!1,tsType:{name:"Nullable",elements:[{name:"number"}],raw:"Nullable<number>"},description:""},parentId:{required:!1,tsType:{name:"string"},description:""},isSelected:{required:!1,tsType:{name:"boolean"},description:""},isExpanded:{required:!1,tsType:{name:"boolean"},description:""},onSelect:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"onSelect is passed by the Tree component when cloning the TreeItem"},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"onClick is the user defined callback to run after the onSelect"},onExpand:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},onShrink:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},projection:{required:!1,tsType:{name:"Nullable",elements:[{name:"signature",type:"object",raw:`{
    depth: number;
    maxDepth: number;
    minDepth: number;
    position: number;
    type?: string;
    accepts?: string;
    parentId: Nullable<string>;
    isWithinParent: boolean | undefined;
    previousNode: Nullable<{ id: string; depth: number; accepts?: string }>;
}`,signature:{properties:[{key:"depth",value:{name:"number",required:!0}},{key:"maxDepth",value:{name:"number",required:!0}},{key:"minDepth",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}},{key:"type",value:{name:"string",required:!1}},{key:"accepts",value:{name:"string",required:!1}},{key:"parentId",value:{name:"Nullable",elements:[{name:"string"}],raw:"Nullable<string>",required:!0}},{key:"isWithinParent",value:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}],required:!0}},{key:"previousNode",value:{name:"Nullable",elements:[{name:"signature",type:"object",raw:"{ id: string; depth: number; accepts?: string }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"depth",value:{name:"number",required:!0}},{key:"accepts",value:{name:"string",required:!1}}]}}],raw:"Nullable<{ id: string; depth: number; accepts?: string }>",required:!0}}]}}],raw:"Nullable<Projection>"},description:""},registerOverlay:{required:!1,tsType:{name:"signature",type:"function",raw:"(overlay: Overlay) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
    id: string;
    label?: string;
    level?: number;
    children: ReactNode;
    contentComponent?: ReactNode;
    isSelected?: boolean;
    dragHandlerPosition?: DragHandlerPosition;
    showContentWhileDragging: boolean;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!1}},{key:"level",value:{name:"number",required:!1}},{key:"children",value:{name:"ReactNode",required:!0}},{key:"contentComponent",value:{name:"ReactNode",required:!1}},{key:"isSelected",value:{name:"boolean",required:!1}},{key:"dragHandlerPosition",value:{name:"union",raw:"'left' | 'right' | 'none'",elements:[{name:"literal",value:"'left'"},{name:"literal",value:"'right'"},{name:"literal",value:"'none'"}],required:!1}},{key:"showContentWhileDragging",value:{name:"boolean",required:!0}}]}},name:"overlay"}],return:{name:"void"}}},description:""},unregisterNodeChildren:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: string) => void",signature:{arguments:[{type:{name:"string"},name:"payload"}],return:{name:"void"}}},description:""},registerNodeChildren:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: RegisterNodeChildrenPayload) => void",signature:{arguments:[{type:{name:"Extract['payload']",raw:"Extract<TreeStateAction, { type: 'REGISTER_NODE_CHILDREN' }>['payload']"},name:"payload"}],return:{name:"void"}}},description:""},draggable:{defaultValue:{value:"true",computed:!1},required:!1},expandable:{defaultValue:{value:"true",computed:!1},required:!1},showDragHandlerOnHoverOnly:{defaultValue:{value:"true",computed:!1},required:!1},dragHandlerPosition:{defaultValue:{value:"'left'",computed:!1},required:!1},showContentWhileDragging:{defaultValue:{value:"true",computed:!1},required:!1},ignoreItemDoubleClick:{defaultValue:{value:"false",computed:!1},required:!1},expandOnSelect:{defaultValue:{value:"false",computed:!1},required:!1},"data-test-id":{defaultValue:{value:"'fondue-tree-item'",computed:!1},required:!1}}};export{xe as T,ht as u};
