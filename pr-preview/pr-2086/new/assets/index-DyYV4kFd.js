import{r as c}from"./index-BwDkhjyp.js";import{u as v}from"./index-Brw_kfkv.js";import{a as S}from"./index-DOnKqARA.js";import{j as O}from"./jsx-runtime-Nms4Y4qS.js";function P(n,e){return c.useReducer((t,r)=>e[t][r]??t,n)}var E=n=>{const{present:e,children:t}=n,r=C(e),i=typeof t=="function"?t({present:r.isPresent}):c.Children.only(t),m=v(r.ref,h(i));return typeof t=="function"||r.isPresent?c.cloneElement(i,{ref:m}):null};E.displayName="Presence";function C(n){const[e,t]=c.useState(),r=c.useRef({}),i=c.useRef(n),m=c.useRef("none"),a=n?"mounted":"unmounted",[u,s]=P(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const o=M(r.current);m.current=u==="mounted"?o:"none"},[u]),S(()=>{const o=r.current,p=i.current;if(p!==n){const d=m.current,l=M(o);n?s("MOUNT"):l==="none"||(o==null?void 0:o.display)==="none"?s("UNMOUNT"):s(p&&d!==l?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,s]),S(()=>{if(e){let o;const p=e.ownerDocument.defaultView??window,f=l=>{const A=M(r.current).includes(l.animationName);if(l.target===e&&A&&(s("ANIMATION_END"),!i.current)){const x=e.style.animationFillMode;e.style.animationFillMode="forwards",o=p.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=x)})}},d=l=>{l.target===e&&(m.current=M(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{p.clearTimeout(o),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else s("ANIMATION_END")},[e,s]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:c.useCallback(o=>{o&&(r.current=getComputedStyle(o)),t(o)},[])}}function M(n){return(n==null?void 0:n.animationName)||"none"}function h(n){var r,i;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(i=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function U(n,e=[]){let t=[];function r(m,a){const u=c.createContext(a),s=t.length;t=[...t,a];const o=f=>{var g;const{scope:d,children:l,...N}=f,A=((g=d==null?void 0:d[n])==null?void 0:g[s])||u,x=c.useMemo(()=>N,Object.values(N));return O.jsx(A.Provider,{value:x,children:l})};o.displayName=m+"Provider";function p(f,d){var A;const l=((A=d==null?void 0:d[n])==null?void 0:A[s])||u,N=c.useContext(l);if(N)return N;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${m}\``)}return[o,p]}const i=()=>{const m=t.map(a=>c.createContext(a));return function(u){const s=(u==null?void 0:u[n])||m;return c.useMemo(()=>({[`__scope${n}`]:{...u,[n]:s}}),[u,s])}};return i.scopeName=n,[r,T(i,...e)]}function T(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(m){const a=r.reduce((u,{useScope:s,scopeName:o})=>{const f=s(m)[`__scope${o}`];return{...u,...f}},{});return c.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}export{E as P,U as c};
